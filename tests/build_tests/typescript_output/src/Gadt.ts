// Generated by ReScript, PLEASE EDIT WITH CARE
import type * as rescript from "@rescript/runtime/types";



type number_$float = number_$Float;
type number_$int = number_$Int;
type number_$Int = { readonly TAG: "Int"; readonly _0: number };
type number_$Float = { readonly TAG: "Float"; readonly _0: number };
export type number_<_ extends number = number> =
  | number_$Int
  | number_$Float;

export type standard = rescript.opaque<"Gadt.standard", []>;

export type daylight = rescript.opaque<"Gadt.daylight", []>;

type timezone$daylight = timezone$EDT | timezone$CDT;
type timezone$standard = timezone$EST | timezone$CST;
type timezone$EST = "EST";
type timezone$EDT = "EDT";
type timezone$CST = "CST";
type timezone$CDT = "CDT";
export type timezone<_ extends standard | daylight = standard | daylight> =
  | timezone$EST
  | timezone$EDT
  | timezone$CST
  | timezone$CDT;

type expr$bool = expr$BoolLit | expr$Eq;
type expr$int = expr$IntLit | expr$Add;
type expr$IntLit = { readonly TAG: "IntLit"; readonly _0: number };
type expr$BoolLit = { readonly TAG: "BoolLit"; readonly _0: boolean };
type expr$Add = {
  readonly TAG: "Add";
  readonly _0: expr$int;
  readonly _1: expr$int;
};
type expr$Eq = {
  readonly TAG: "Eq";
  readonly _0: expr$int;
  readonly _1: expr$int;
};
type expr$If = {
  readonly TAG: "If";
  readonly _0: expr$bool;
  readonly _1: expr;
  readonly _2: expr;
};
export type expr<_ extends number | boolean = number | boolean> =
  | expr$IntLit
  | expr$BoolLit
  | expr$Add
  | expr$Eq
  | expr$If;

function add(x: number_, y: number_): number {
  if (x.TAG === "Int") {
    return x._0 + y._0 | 0;
  } else {
    return x._0 + y._0;
  }
}

function convertToDaylight(tz: timezone$standard): timezone$daylight {
  if (tz === "EST") {
    return "EDT";
  } else {
    return "CDT";
  }
}

function $$eval(_expr: expr$bool): boolean;
function $$eval(_expr: expr$int): number;
function $$eval(_expr: expr): number | boolean {
  while (true) {
    let expr = _expr;
    switch (expr.TAG) {
      case "IntLit" :
      case "BoolLit" :
        return expr._0;
      case "Add" :
        return $$eval(expr._0) + $$eval(expr._1) | 0;
      case "Eq" :
        return $$eval(expr._0) === $$eval(expr._1);
      case "If" :
        if ($$eval(expr._0)) {
          _expr = expr._1;
          continue;
        }
        _expr = expr._2;
        continue;
    }
  };
}

let addResult: number = add({
  TAG: "Int",
  _0: 1
}, {
  TAG: "Int",
  _0: 2
});

let daylightResult: timezone$daylight = "EDT";

let evalResult: number = $$eval({
  TAG: "Add",
  _0: {
    TAG: "IntLit",
    _0: 10
  },
  _1: {
    TAG: "IntLit",
    _0: 20
  }
});

let intNum: number_$int = {
  TAG: "Int",
  _0: 42
};

let floatNum: number_$float = {
  TAG: "Float",
  _0: 3.14
};

let estTz: timezone$standard = "EST";

let edtTz: timezone$daylight = "EDT";

let intExpr: expr$int = {
  TAG: "IntLit",
  _0: 5
};

let boolExpr: expr$bool = {
  TAG: "BoolLit",
  _0: true
};

let addExpr: expr$int = {
  TAG: "Add",
  _0: {
    TAG: "IntLit",
    _0: 1
  },
  _1: {
    TAG: "IntLit",
    _0: 2
  }
};

let eqExpr: expr$bool = {
  TAG: "Eq",
  _0: {
    TAG: "IntLit",
    _0: 1
  },
  _1: {
    TAG: "IntLit",
    _0: 1
  }
};

export {
  add,
  convertToDaylight,
  $$eval,
  intNum,
  floatNum,
  estTz,
  edtTz,
  intExpr,
  boolExpr,
  addExpr,
  eqExpr,
  addResult,
  daylightResult,
  evalResult,
}
/* addResult Not a pure module */
